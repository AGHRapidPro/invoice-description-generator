<div class="content">

  <h3 class="main-header">Generator Zamówień Publicznych</h3>
  <div style="display: grid">

    <h5 class="section-header">Rodzaj dokumentu:</h5>

    <mat-radio-group class="radio-group" [(ngModel)]="invoiceType">
      <mat-radio-button [value]="InvoiceType.VatReturn">Opis faktury VAT ze zwrotem na konto</mat-radio-button>
      <mat-radio-button [value]="InvoiceType.VatNoReturn">Opis faktury VAT bez zwrotu na konto</mat-radio-button>
      <mat-radio-button [value]="InvoiceType.Proforma">Opis faktury proforma</mat-radio-button>
    </mat-radio-group>

    <h5 class="section-header">Numer faktury {{invoiceType === InvoiceType.Proforma ? "Proforma" : "VAT"}}</h5>

    <mat-form-field appearance="outline">
      <mat-label>Wpisz numer faktury {{invoiceType === InvoiceType.Proforma ? "Proforma" : "VAT"}} </mat-label>
      <input [(ngModel)]="invoiceDocument.invoiceNumber" matInput required>
    </mat-form-field>

    <h5 class="section-header">Krótki opis faktury (Za co jest?)</h5>

    <mat-form-field appearance="outline">
      <mat-label>Wpisz krótki opis faktury VAT</mat-label>
      <input [(ngModel)]="invoiceDocument.invoiceDescription" matInput required>
    </mat-form-field>

    <h5 class="section-header">Podstawa udzielenia zamównienia</h5>

    <mat-form-field appearance="outline">
      <mat-label>Wybierz podstawę udzielenia zamówienia</mat-label>
      <mat-select [(ngModel)]="invoiceDocument.contractBasis" required>
        <mat-option *ngFor="let basis of contractBasis" [value]="basis">{{basis}}</mat-option>
      </mat-select>
    </mat-form-field>

    <h5 class="section-header">Grant zamównienia</h5>

    <mat-form-field appearance="outline">
      <mat-label>Wybierz grant</mat-label>
      <mat-select [(ngModel)]="invoiceDocument.financeGrant" required>
        <mat-option *ngFor="let grant of grantList" [value]="grant">
          {{grant.alias}}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <ng-container *ngIf="invoiceType === InvoiceType.VatReturn">

      <h5 class="section-header">Odbiorca przelewu</h5>

      <mat-form-field appearance="outline">
        <mat-label>Wybierz odbiorcę przelewu</mat-label>
        <mat-select [(ngModel)]="invoiceDocument.recipient" required>
          <mat-option *ngFor="let recipient of recipientsList" [value]="recipient">
            {{recipient.name}} {{recipient.lastname}}, {{recipient.index}}
          </mat-option>
        </mat-select>
      </mat-form-field>

    </ng-container>

    <mat-divider></mat-divider>

    <h5 class="section-header">Pozycje z faktury</h5>

    <div *ngIf="dataSource.data.length == 0" class="empty-list-paragraph">
      Brak pozycji do wyświetlenia. Dodaj pozycje do faktury klikając przycisk!
    </div>

    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8 data-table" *ngIf="dataSource.data.length > 0">

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Nazwa</th>
        <td mat-cell *matCellDef="let element">{{element.name}}</td>
      </ng-container>

      <ng-container matColumnDef="cpvRow">
        <th mat-header-cell *matHeaderCellDef>Wiersz</th>
        <td mat-cell *matCellDef="let element">{{element.cpv.row}}</td>
      </ng-container>

      <ng-container matColumnDef="cpvId">
        <th mat-header-cell *matHeaderCellDef>Kod CPV</th>
        <td mat-cell *matCellDef="let element">{{element.cpv.id}}</td>
      </ng-container>

      <ng-container matColumnDef="cpvName">
        <th mat-header-cell *matHeaderCellDef>Nazwa CPV</th>
        <td mat-cell *matCellDef="let element">{{element.cpv.name}}</td>
      </ng-container>

      <ng-container matColumnDef="invoicePosition">
        <th mat-header-cell *matHeaderCellDef>Pozycje z faktury</th>
        <td mat-cell *matCellDef="let element">{{element.invoicePosition}}</td>
      </ng-container>

      <ng-container matColumnDef="preliminaryId">
        <th mat-header-cell *matHeaderCellDef>Nr pozycji wg preliminarza</th>
        <td mat-cell *matCellDef="let element">{{element.preliminaryId}}</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <div class="footer">
      <button
        class="footer-button"
        color="primary"
        (click)="addItem()"
        [disabled]="!invoiceDocument.financeGrant"
        mat-stroked-button
        >
        Dodaj pozycję do faktury
      </button>
      <button
        color="accent"
        class="footer-button"
        (click)="generatePdf()"
        [disabled]="disableButtonGenerate()"
        mat-raised-button
      >
        Pobierz plik PDF z fakturą
      </button>
    </div>

  </div>
</div>
